<!DOCTYPE html>
<html lang="zh" dir="auto">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>DockerFile和DockerCompose基本使用 | phjhq&#39;s Blog</title>
<meta name="keywords" content="Docker">
<meta name="description" content="DockerFile的基本使用
为什么要使用
之前的方式去部署应用还是有点繁琐，因为之前使用的镜像并不能很好的符合我们自己的需求。">
<meta name="author" content="phjhq">
<link rel="canonical" href="http://localhost:1313/posts/dockerfile%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.73849ddbacd99e7f7f65fef830da533e08a3f4b2fad9ce732c65c06701f1000b.css" integrity="sha256-c4Sd26zZnn9/Zf74MNpTPgij9LL62c5zLGXAZwHxAAs=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://localhost:1313/favicon.png">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/favicon.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/favicon.png">
<link rel="apple-touch-icon" href="http://localhost:1313/favicon.png">
<link rel="mask-icon" href="http://localhost:1313/favicon.png">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="zh" href="http://localhost:1313/posts/dockerfile%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
</noscript><link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:ital,wght@0,100..800;1,100..800&display=swap"
  rel="stylesheet">

<script type="text/javascript" async
  src="https://cdn.bootcss.com/mathjax/2.7.3/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
    MathJax.Hub.Config({
      tex2jax: {
        inlineMath: [['$', '$'], ['\\(', '\\)']],
        displayMath: [['$$', '$$'], ['\[\[', '\]\]']],
        processEscapes: true,
        processEnvironments: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
        TeX: {
          equationNumbers: { autoNumber: "AMS" },
          extensions: ["AMSmath.js", "AMSsymbols.js"]
        }
      }
    });

    MathJax.Hub.Queue(function () {
      
      
      
      var all = MathJax.Hub.getAllJax(), i;
      for (i = 0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';
      }
    });
  </script>

<style>
  code.has-jax {
    font: inherit;
    font-size: 100%;
    background: inherit;
    border: inherit;
    color: #515151;
  }
</style><meta property="og:title" content="DockerFile和DockerCompose基本使用" />
<meta property="og:description" content="DockerFile的基本使用
为什么要使用
之前的方式去部署应用还是有点繁琐，因为之前使用的镜像并不能很好的符合我们自己的需求。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://localhost:1313/posts/dockerfile%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8/" />
<meta property="og:image" content="https://i.postimg.cc/7hwBy7VS/calcr.png" />
<meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-10-16T13:53:02+08:00" />
<meta property="article:modified_time" content="2024-10-16T13:53:02+08:00" />

<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://i.postimg.cc/7hwBy7VS/calcr.png" />
<meta name="twitter:title" content="DockerFile和DockerCompose基本使用"/>
<meta name="twitter:description" content="DockerFile的基本使用
为什么要使用
之前的方式去部署应用还是有点繁琐，因为之前使用的镜像并不能很好的符合我们自己的需求。"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "http://localhost:1313/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "DockerFile和DockerCompose基本使用",
      "item": "http://localhost:1313/posts/dockerfile%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "DockerFile和DockerCompose基本使用",
  "name": "DockerFile和DockerCompose基本使用",
  "description": "DockerFile的基本使用 为什么要使用 之前的方式去部署应用还是有点繁琐，因为之前使用的镜像并不能很好的符合我们自己的需求。\n",
  "keywords": [
    "Docker"
  ],
  "articleBody": "DockerFile的基本使用 为什么要使用 之前的方式去部署应用还是有点繁琐，因为之前使用的镜像并不能很好的符合我们自己的需求。\n使用dockerFile可以自定义镜像\n快速入门 构建一个最简单的HelloWorld镜像\n创建一个文件 1sudo mkdir images 在文件中编写相关指令 FROM ubuntu:22.04 CMD [\"echo\",\"helloworld\"] 编译镜像 1docker build -t hello:1.0 -f HelloWorld . 容器运行测试 1docker run hello:1.0 指令学习 FROM 作用\n定义基础镜像\n用法\nFROM 镜像名:标签名\nFROM ubuntu：22.04\n作用时机\n构建镜像的时候\nCMD 作用\n用来定义容器运行时的默认命令。可以在使用docker run的时候覆盖掉CMD中定义的命令\n用法\nCMD [“命令1”，“参数1”,“参数2”]\nCMD echo $HOME\n注意\n一个DockerFile中写多个CMD的时候只有最后一个CMD会去作用\nENV 作用\n用来定义环境变量\n用法\nENV 变量名=“变量值”\n作用时机\n构建镜像的时候\n脚本\n1#第一种使用参数的方法 2FROM ubuntu:22.04 3ENV CONTENT hello 4CMD [\"sh\",\"-c\",\"echo $CONTENT\"] 5#第二种使用参数的方法 6FROM ubuntu:22.04 7ENV CONTENT=\"helloword\" 8CMD echo $CONTENT RUN 作用\n它是用来定义构建过程中要执行的命令的\n用法\nRUN 命令\n例如：RUN echo sg\n作用时机\n构建镜像的时候\nWORKDIR 作用\n用于设置当前工作的目录，如果该目录不存在会自动创建。\n用法\nWORKDIR 目录\nWORKDIR /root/app\n作用时机\n构建镜像的时候\n案例：\n定义一个CONTENT变量，默认值为hellodocker，在镜像的/app目录下创建一个sg目录，在其中创建一个content.txt文件，文件的内容为CONTENT变量的值。容器启动时打印content.txt的内容\n在Linux环境下执行这些命令\n1export CONTENT=hellodocker 2mkdir /app 3cd /app 4mkdir sg 5cd sg 6echo $CONTINT\u003econtent.txt 7cat content.txt 使用dockerfile构建响应的容器\n1FROM ubuntu:22.04 2ENV CONTINT=\"hellodocker\" 3WORKDIR /app/sg 4RUN echo $CONTINT\u003econtent.txt 5CMD [\"cat\",\"content.txt\"] 构建 1docker build -t test:2.0 -f Test1 . 运行 1docekr run test:2.0 ADD 作用\n把构建上下文中的文件或者网络文件添加到镜像中，如果文件是一个压缩包会自动解压，如果是网络中的文件并不会自动解压\n用法\nADD 原路径 目标路径\nADD sg-blog-vue.tar.gz .\n作用时机\n构建镜像的时候\nEXPOSE 作用\n暴露需要发布的端口，让镜像使用者知道应该发布哪些端口\n用法\nEXPOSE 端口号1 端口号2 ….\nEXPOSE 80 8080\n作用时机\n构建镜像的时候\nCOPY 作用\n从构建上下文中复制内容到镜像中\n用法\nCOPY 原路径 目标路径\nCOPY sg-blog-vue.tar.gz .\nENTRYPOINT 作用\n用来定义容器运行时的默认命令。docker run的时候无法覆盖ENTRYPOINT里的内容。\n作用时机\n运行容器的时候\n用法\nENTRYPOINT [“命令1”,“参数1”,“参数2”]\nENTRYPOINT [“echo”,“helloworld”]\n解释\n与CMD结合，把不希望被覆盖的命令用ENTRYPOINNT定义，其他部分用CMD定义，这样启动容器的时候只会覆盖CMD的部分\n例\nENTRYPOINT [“java”,\"-jar\"] CMD [“app.jar”]\n上述写法的app.jar就是可以被覆盖的，而java -jar就是不能被覆盖\n上传镜像 注册账号\n上传镜像需要有dockerhub的账号\n本地登录验证\ndocker login\n然后输入用户名和密码\n给镜像打标签\ndocker tag username/镜像名:tag #username是DockerHub的用户名\n推送镜像\ndocker push username/镜像名:tag\nDockerCompose的基本使用 概述 为什么要学习 我们在部署运行一个项目的时候可能需要运行多个容器。 还要去处理这些容器的网络，数据卷等。 如果用docker命令一个个去处理还是不方便。 DockerCompose就是去解决这个问题的。\nDockerCompose是用来定义和运行一个或多个容器(通常都是多个)运行和应用的工具\n可以使用 YAML 文件来配置应用程序的服务。然后，使用单个命令，您可以根据配置创建并启动所有服务。\n检查是否安装DockerCompose 使用docker compose version 可以查看版本\n快速入门 编写docker-compose.yaml模板文件 运行 docker compose up -d 停止 docker compose down 默认运行的文件时docker-compose，当使用docker compose up时会自动寻找docker-compose.yaml这个文件，如果更改文件名需要添加新的参数进行指定文件位置\n1docker-compose -f docker-compose.override.yml up 模板文件中的元素 command 覆盖容器启动后的默认指令 environment 指定环境变量，相当于run的-e选项 image 用来指定镜像 networks 指定网络，相当于run的–network ports 用来指定要发布的端口，相当于run的-p volumes 用来指定数据卷，相当于-v restart 用来指定重启策略，相当于–restart 案例\n在之前自定义镜像版本的基础上，用DockerCompose来部署\n1services: 2 # mysql 3 blog_mysql: 4 image: mysql:5.7 5 volumes: 6 - mysql_data:/var/lib/mysql 7 ports: 8 - 3306:3306 9 environment: 10 MYSQL_ROOT_PASSWORD: ******* 11 restart: always 12 networks: 13 - blog_net 14 # redis 15 blog_redis: 16 image: redis:7.0 17 volumes: 18 - redis_data:/data 19 ports: 20 - 6379:6379 21 restart: always 22 command: ['redis-server','--appendonly','yes'] 23 networks: 24 - blog_net 25 # 后端服务 26 sg_blog: 27 image: sg_blog:01 28 ports: 29 - 7777:7777 30 networks: 31 - blog_net 32 restart: always 33 # 前端服务 34 sg_blog_vue: 35 image: sg_blog_vue:01 36 ports: 37 - 80:80 38 restart: always 39 40networks: 41 blog_net: 42 43volumes: 44 mysql_data: 45 #使用已经存在的数据卷 46 external: true 47 redis_data: 48 external: true ",
  "wordCount" : "1876",
  "inLanguage": "zh",
  "image": "https://i.postimg.cc/7hwBy7VS/calcr.png","datePublished": "2024-10-16T13:53:02+08:00",
  "dateModified": "2024-10-16T13:53:02+08:00",
  "author":{
    "@type": "Person",
    "name": "phjhq"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "http://localhost:1313/posts/dockerfile%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "phjhq's Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "http://localhost:1313/favicon.png"
    }
  }
}
</script>
</head>

<body class=" dark" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://localhost:1313/" accesskey="h" title="phjhq&#39;s Blog (Alt + H)">phjhq&#39;s Blog</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="http://localhost:1313/" title="首页">
                    <span>首页</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/archives/" title="归档">
                    <span>归档</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/categories/" title="分类">
                    <span>分类</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/tags/" title="标签">
                    <span>标签</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/search/" title="搜索">
                    <span>搜索</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/about/" title="友链">
                    <span>友链</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title entry-hint-parent">
      DockerFile和DockerCompose基本使用
    </h1>
    <div class="post-meta"><span title='2024-10-16 13:53:02 +0800 CST'>2024-10-16</span>&nbsp;·&nbsp;4 分钟&nbsp;·&nbsp;phjhq

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">目录</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#dockerfile%e7%9a%84%e5%9f%ba%e6%9c%ac%e4%bd%bf%e7%94%a8" aria-label="DockerFile的基本使用">DockerFile的基本使用</a><ul>
                        
                <li>
                    <a href="#%e4%b8%ba%e4%bb%80%e4%b9%88%e8%a6%81%e4%bd%bf%e7%94%a8" aria-label="为什么要使用">为什么要使用</a></li>
                <li>
                    <a href="#%e5%bf%ab%e9%80%9f%e5%85%a5%e9%97%a8" aria-label="快速入门">快速入门</a></li>
                <li>
                    <a href="#%e6%8c%87%e4%bb%a4%e5%ad%a6%e4%b9%a0" aria-label="指令学习">指令学习</a><ul>
                        
                <li>
                    <a href="#from" aria-label="FROM">FROM</a></li>
                <li>
                    <a href="#cmd" aria-label="CMD">CMD</a></li>
                <li>
                    <a href="#env" aria-label="ENV">ENV</a></li>
                <li>
                    <a href="#run" aria-label="RUN">RUN</a></li>
                <li>
                    <a href="#workdir" aria-label="WORKDIR">WORKDIR</a></li>
                <li>
                    <a href="#add" aria-label="ADD">ADD</a></li>
                <li>
                    <a href="#expose" aria-label="EXPOSE">EXPOSE</a></li>
                <li>
                    <a href="#copy" aria-label="COPY">COPY</a></li>
                <li>
                    <a href="#entrypoint" aria-label="ENTRYPOINT">ENTRYPOINT</a></li></ul>
                </li>
                <li>
                    <a href="#%e4%b8%8a%e4%bc%a0%e9%95%9c%e5%83%8f" aria-label="上传镜像">上传镜像</a></li></ul>
                </li>
                <li>
                    <a href="#dockercompose%e7%9a%84%e5%9f%ba%e6%9c%ac%e4%bd%bf%e7%94%a8" aria-label="DockerCompose的基本使用">DockerCompose的基本使用</a><ul>
                        
                <li>
                    <a href="#%e6%a6%82%e8%bf%b0" aria-label="概述">概述</a></li>
                <li>
                    <a href="#%e5%bf%ab%e9%80%9f%e5%85%a5%e9%97%a8-1" aria-label="快速入门">快速入门</a></li>
                <li>
                    <a href="#%e6%a8%a1%e6%9d%bf%e6%96%87%e4%bb%b6%e4%b8%ad%e7%9a%84%e5%85%83%e7%b4%a0" aria-label="模板文件中的元素">模板文件中的元素</a><ul>
                        
                <li>
                    <a href="#command" aria-label="command">command</a></li>
                <li>
                    <a href="#environment" aria-label="environment">environment</a></li>
                <li>
                    <a href="#image" aria-label="image">image</a></li>
                <li>
                    <a href="#networks" aria-label="networks">networks</a></li>
                <li>
                    <a href="#ports" aria-label="ports">ports</a></li>
                <li>
                    <a href="#volumes" aria-label="volumes">volumes</a></li>
                <li>
                    <a href="#restart" aria-label="restart">restart</a>
                </li>
            </ul>
            </li>
            </ul>
            </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><h1 id="dockerfile的基本使用">DockerFile的基本使用<a hidden class="anchor" aria-hidden="true" href="#dockerfile的基本使用">#</a></h1>
<h2 id="为什么要使用">为什么要使用<a hidden class="anchor" aria-hidden="true" href="#为什么要使用">#</a></h2>
<p>之前的方式去部署应用还是有点繁琐，因为之前使用的镜像并不能很好的符合我们自己的需求。</p>
<p>使用dockerFile可以自定义镜像</p>
<h2 id="快速入门">快速入门<a hidden class="anchor" aria-hidden="true" href="#快速入门">#</a></h2>
<p><strong>构建一个最简单的HelloWorld镜像</strong></p>
<ul>
<li>创建一个文件</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="ln">1</span><span class="cl">sudo mkdir images
</span></span></code></pre></div><ul>
<li>在文件中编写相关指令</li>
</ul>
<pre tabindex="0"><code>FROM ubuntu:22.04
CMD [&#34;echo&#34;,&#34;helloworld&#34;]
</code></pre><ul>
<li>编译镜像</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="ln">1</span><span class="cl">docker build -t hello:1.0 -f HelloWorld .
</span></span></code></pre></div><ul>
<li>容器运行测试</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="ln">1</span><span class="cl">docker run hello:1.0
</span></span></code></pre></div><h2 id="指令学习">指令学习<a hidden class="anchor" aria-hidden="true" href="#指令学习">#</a></h2>
<h3 id="from">FROM<a hidden class="anchor" aria-hidden="true" href="#from">#</a></h3>
<ul>
<li>
<p>作用</p>
<p>定义基础镜像</p>
</li>
<li>
<p>用法</p>
<p>FROM 镜像名:标签名</p>
<p>FROM ubuntu：22.04</p>
</li>
<li>
<p>作用时机</p>
<p>构建镜像的时候</p>
</li>
</ul>
<h3 id="cmd">CMD<a hidden class="anchor" aria-hidden="true" href="#cmd">#</a></h3>
<ul>
<li>
<p>作用</p>
<p>用来定义容器运行时的默认命令。可以在使用docker run的时候覆盖掉CMD中定义的命令</p>
</li>
<li>
<p>用法</p>
<p>CMD [&ldquo;命令1&rdquo;，“参数1”,&ldquo;参数2&rdquo;]</p>
<p>CMD echo $HOME</p>
<p><img loading="lazy" src="https://i.postimg.cc/hGVyPHxk/screenshot-48.png" alt=""  />
</p>
</li>
<li>
<p>注意</p>
<p>一个DockerFile中写多个CMD的时候只有最后一个CMD会去作用</p>
</li>
</ul>
<h3 id="env">ENV<a hidden class="anchor" aria-hidden="true" href="#env">#</a></h3>
<ul>
<li>
<p>作用</p>
<p>用来定义环境变量</p>
</li>
<li>
<p>用法</p>
<p>ENV 变量名=&ldquo;变量值&rdquo;</p>
</li>
<li>
<p>作用时机</p>
<p>构建镜像的时候</p>
</li>
<li>
<p>脚本</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="ln">1</span><span class="cl"><span class="c1">#第一种使用参数的方法</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl">FROM ubuntu:22.04
</span></span><span class="line"><span class="ln">3</span><span class="cl">ENV CONTENT hello
</span></span><span class="line"><span class="ln">4</span><span class="cl">CMD <span class="o">[</span><span class="s2">&#34;sh&#34;</span>,<span class="s2">&#34;-c&#34;</span>,<span class="s2">&#34;echo </span><span class="nv">$CONTENT</span><span class="s2">&#34;</span><span class="o">]</span>
</span></span><span class="line"><span class="ln">5</span><span class="cl"><span class="c1">#第二种使用参数的方法</span>
</span></span><span class="line"><span class="ln">6</span><span class="cl">FROM ubuntu:22.04
</span></span><span class="line"><span class="ln">7</span><span class="cl">ENV <span class="nv">CONTENT</span><span class="o">=</span><span class="s2">&#34;helloword&#34;</span>
</span></span><span class="line"><span class="ln">8</span><span class="cl">CMD <span class="nb">echo</span> <span class="nv">$CONTENT</span>
</span></span></code></pre></div></li>
</ul>
<h3 id="run">RUN<a hidden class="anchor" aria-hidden="true" href="#run">#</a></h3>
<ul>
<li>
<p>作用</p>
<p>它是用来定义构建过程中要执行的命令的</p>
</li>
<li>
<p>用法</p>
<p>RUN 命令</p>
<p>例如：RUN echo sg</p>
</li>
<li>
<p>作用时机</p>
<p>构建镜像的时候</p>
</li>
</ul>
<h3 id="workdir">WORKDIR<a hidden class="anchor" aria-hidden="true" href="#workdir">#</a></h3>
<ul>
<li>
<p>作用</p>
<p>用于设置当前工作的目录，如果该目录不存在会自动创建。</p>
</li>
<li>
<p>用法</p>
<p>WORKDIR 目录</p>
<p>WORKDIR /root/app</p>
</li>
<li>
<p>作用时机</p>
<p>构建镜像的时候</p>
</li>
</ul>
<p>案例：</p>
<p>定义一个CONTENT变量，默认值为hellodocker，在镜像的/app目录下创建一个sg目录，在其中创建一个content.txt文件，文件的内容为CONTENT变量的值。容器启动时打印content.txt的内容</p>
<ul>
<li>
<p>在Linux环境下执行这些命令</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="ln">1</span><span class="cl"><span class="nb">export</span> <span class="nv">CONTENT</span><span class="o">=</span>hellodocker
</span></span><span class="line"><span class="ln">2</span><span class="cl">mkdir /app
</span></span><span class="line"><span class="ln">3</span><span class="cl"><span class="nb">cd</span> /app
</span></span><span class="line"><span class="ln">4</span><span class="cl">mkdir sg
</span></span><span class="line"><span class="ln">5</span><span class="cl"><span class="nb">cd</span> sg
</span></span><span class="line"><span class="ln">6</span><span class="cl"><span class="nb">echo</span> <span class="nv">$CONTINT</span>&gt;content.txt
</span></span><span class="line"><span class="ln">7</span><span class="cl">cat content.txt
</span></span></code></pre></div></li>
<li>
<p>使用dockerfile构建响应的容器</p>
</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-dockerfile" data-lang="dockerfile"><span class="line"><span class="ln">1</span><span class="cl"><span class="k">FROM</span><span class="s"> ubuntu:22.04</span><span class="err">
</span></span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="err"></span><span class="k">ENV</span> <span class="nv">CONTINT</span><span class="o">=</span><span class="s2">&#34;hellodocker&#34;</span><span class="err">
</span></span></span><span class="line"><span class="ln">3</span><span class="cl"><span class="err"></span><span class="k">WORKDIR</span><span class="s"> /app/sg</span><span class="err">
</span></span></span><span class="line"><span class="ln">4</span><span class="cl"><span class="err"></span><span class="k">RUN</span> <span class="nb">echo</span> <span class="nv">$CONTINT</span>&gt;content.txt<span class="err">
</span></span></span><span class="line"><span class="ln">5</span><span class="cl"><span class="err"></span><span class="k">CMD</span> <span class="p">[</span><span class="s2">&#34;cat&#34;</span><span class="p">,</span><span class="s2">&#34;content.txt&#34;</span><span class="p">]</span><span class="err">
</span></span></span></code></pre></div><ul>
<li>构建</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="ln">1</span><span class="cl">docker build -t test:2.0 -f Test1 .
</span></span></code></pre></div><ul>
<li>运行</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="ln">1</span><span class="cl">docekr run test:2.0
</span></span></code></pre></div><h3 id="add">ADD<a hidden class="anchor" aria-hidden="true" href="#add">#</a></h3>
<ul>
<li>
<p>作用</p>
<p>把构建上下文中的文件或者网络文件添加到镜像中，如果文件是一个压缩包会自动解压，如果是网络中的文件并不会自动解压</p>
</li>
<li>
<p>用法</p>
<p>ADD 原路径 目标路径</p>
<p>ADD sg-blog-vue.tar.gz .</p>
</li>
<li>
<p>作用时机</p>
<p>构建镜像的时候</p>
</li>
</ul>
<h3 id="expose">EXPOSE<a hidden class="anchor" aria-hidden="true" href="#expose">#</a></h3>
<ul>
<li>
<p>作用</p>
<p>暴露需要发布的端口，让镜像使用者知道应该发布哪些端口</p>
</li>
<li>
<p>用法</p>
<p>EXPOSE 端口号1 端口号2 &hellip;.</p>
<p>EXPOSE 80 8080</p>
</li>
<li>
<p>作用时机</p>
<p>构建镜像的时候</p>
</li>
</ul>
<h3 id="copy">COPY<a hidden class="anchor" aria-hidden="true" href="#copy">#</a></h3>
<ul>
<li>
<p>作用</p>
<p>从构建上下文中复制内容到镜像中</p>
</li>
<li>
<p>用法</p>
<p>COPY 原路径 目标路径</p>
<p>COPY sg-blog-vue.tar.gz .</p>
</li>
</ul>
<h3 id="entrypoint">ENTRYPOINT<a hidden class="anchor" aria-hidden="true" href="#entrypoint">#</a></h3>
<ul>
<li>
<p>作用</p>
<p>用来定义容器运行时的默认命令。docker run的时候无法覆盖ENTRYPOINT里的内容。</p>
</li>
<li>
<p>作用时机</p>
<p>运行容器的时候</p>
</li>
<li>
<p>用法</p>
<p>ENTRYPOINT [&ldquo;命令1&rdquo;,&ldquo;参数1&rdquo;,&ldquo;参数2&rdquo;]</p>
<p>ENTRYPOINT [&ldquo;echo&rdquo;,&ldquo;helloworld&rdquo;]</p>
</li>
<li>
<p>解释</p>
<p>与CMD结合，把不希望被覆盖的命令用ENTRYPOINNT定义，其他部分用CMD定义，这样启动容器的时候只会覆盖CMD的部分</p>
</li>
<li>
<p>例</p>
<p>ENTRYPOINT [&ldquo;java&rdquo;,&quot;-jar&quot;] CMD [&ldquo;app.jar&rdquo;]</p>
<p>上述写法的app.jar就是可以被覆盖的，而java -jar就是不能被覆盖</p>
</li>
</ul>
<h2 id="上传镜像">上传镜像<a hidden class="anchor" aria-hidden="true" href="#上传镜像">#</a></h2>
<ul>
<li>
<p>注册账号</p>
<p>上传镜像需要有dockerhub的账号</p>
</li>
<li>
<p>本地登录验证</p>
<p>docker login</p>
<p>然后输入用户名和密码</p>
</li>
<li>
<p>给镜像打标签</p>
<p>docker tag username/镜像名:tag   #username是DockerHub的用户名</p>
</li>
<li>
<p>推送镜像</p>
<p>docker push username/镜像名:tag</p>
</li>
</ul>
<h1 id="dockercompose的基本使用">DockerCompose的基本使用<a hidden class="anchor" aria-hidden="true" href="#dockercompose的基本使用">#</a></h1>
<h2 id="概述">概述<a hidden class="anchor" aria-hidden="true" href="#概述">#</a></h2>
<ul>
<li>为什么要学习</li>
</ul>
<p>我们在部署运行一个项目的时候可能需要运行多个容器。 还要去处理这些容器的网络，数据卷等。  如果用docker命令一个个去处理还是不方便。 DockerCompose就是去解决这个问题的。</p>
<p>DockerCompose是用来定义和运行一个或多个容器(通常都是多个)运行和应用的工具</p>
<p>可以使用 YAML 文件来配置应用程序的服务。然后，使用单个命令，您可以根据配置创建并启动所有服务。</p>
<ul>
<li>检查是否安装DockerCompose</li>
</ul>
<p>使用docker compose version 可以查看版本</p>
<p><img loading="lazy" src="https://i.postimg.cc/26JJFNKw/screenshot-49.png" alt=""  />
</p>
<h2 id="快速入门-1">快速入门<a hidden class="anchor" aria-hidden="true" href="#快速入门-1">#</a></h2>
<ul>
<li>编写docker-compose.yaml模板文件</li>
<li>运行 docker compose up -d</li>
<li>停止 docker compose down</li>
</ul>
<p>默认运行的文件时docker-compose，当使用docker compose up时会自动寻找docker-compose.yaml这个文件，如果更改文件名需要添加新的参数进行指定文件位置</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="ln">1</span><span class="cl">docker-compose -f docker-compose.override.yml up
</span></span></code></pre></div><h2 id="模板文件中的元素">模板文件中的元素<a hidden class="anchor" aria-hidden="true" href="#模板文件中的元素">#</a></h2>
<h3 id="command">command<a hidden class="anchor" aria-hidden="true" href="#command">#</a></h3>
<ul>
<li>覆盖容器启动后的默认指令</li>
</ul>
<h3 id="environment">environment<a hidden class="anchor" aria-hidden="true" href="#environment">#</a></h3>
<ul>
<li>指定环境变量，相当于run的-e选项</li>
</ul>
<h3 id="image">image<a hidden class="anchor" aria-hidden="true" href="#image">#</a></h3>
<ul>
<li>用来指定镜像</li>
</ul>
<h3 id="networks">networks<a hidden class="anchor" aria-hidden="true" href="#networks">#</a></h3>
<ul>
<li>指定网络，相当于run的&ndash;network</li>
</ul>
<h3 id="ports">ports<a hidden class="anchor" aria-hidden="true" href="#ports">#</a></h3>
<ul>
<li>用来指定要发布的端口，相当于run的-p</li>
</ul>
<h3 id="volumes">volumes<a hidden class="anchor" aria-hidden="true" href="#volumes">#</a></h3>
<ul>
<li>用来指定数据卷，相当于-v</li>
</ul>
<h3 id="restart">restart<a hidden class="anchor" aria-hidden="true" href="#restart">#</a></h3>
<ul>
<li>用来指定重启策略，相当于&ndash;restart</li>
</ul>
<p>案例</p>
<p>在之前自定义镜像版本的基础上，用DockerCompose来部署</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="nt">services</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="w">  </span><span class="c"># mysql</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="w">  </span><span class="nt">blog_mysql</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">mysql:5.7</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="w">    </span><span class="nt">volumes</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="w">      </span>- <span class="l">mysql_data:/var/lib/mysql</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="w">    </span><span class="nt">ports</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="w">      </span>- <span class="m">3306</span><span class="p">:</span><span class="m">3306</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="w">    </span><span class="nt">environment</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="w">      </span><span class="nt">MYSQL_ROOT_PASSWORD</span><span class="p">:</span><span class="w"> </span><span class="cp">*******</span><span class="w">
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="l">always</span><span class="w">
</span></span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="w">    </span><span class="nt">networks</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="w">      </span>- <span class="l">blog_net</span><span class="w">
</span></span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="w">  </span><span class="c"># redis</span><span class="w">
</span></span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="w">  </span><span class="nt">blog_redis</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln">16</span><span class="cl"><span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">redis:7.0</span><span class="w">
</span></span></span><span class="line"><span class="ln">17</span><span class="cl"><span class="w">    </span><span class="nt">volumes</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln">18</span><span class="cl"><span class="w">      </span>- <span class="l">redis_data:/data</span><span class="w">
</span></span></span><span class="line"><span class="ln">19</span><span class="cl"><span class="w">    </span><span class="nt">ports</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="w">      </span>- <span class="m">6379</span><span class="p">:</span><span class="m">6379</span><span class="w">
</span></span></span><span class="line"><span class="ln">21</span><span class="cl"><span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="l">always</span><span class="w">
</span></span></span><span class="line"><span class="ln">22</span><span class="cl"><span class="w">    </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;redis-server&#39;</span><span class="p">,</span><span class="s1">&#39;--appendonly&#39;</span><span class="p">,</span><span class="s1">&#39;yes&#39;</span><span class="p">]</span><span class="w">
</span></span></span><span class="line"><span class="ln">23</span><span class="cl"><span class="w">    </span><span class="nt">networks</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln">24</span><span class="cl"><span class="w">      </span>- <span class="l">blog_net</span><span class="w">
</span></span></span><span class="line"><span class="ln">25</span><span class="cl"><span class="w">  </span><span class="c"># 后端服务</span><span class="w">
</span></span></span><span class="line"><span class="ln">26</span><span class="cl"><span class="w">  </span><span class="nt">sg_blog</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln">27</span><span class="cl"><span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">sg_blog:01</span><span class="w">
</span></span></span><span class="line"><span class="ln">28</span><span class="cl"><span class="w">    </span><span class="nt">ports</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln">29</span><span class="cl"><span class="w">      </span>- <span class="m">7777</span><span class="p">:</span><span class="m">7777</span><span class="w">
</span></span></span><span class="line"><span class="ln">30</span><span class="cl"><span class="w">    </span><span class="nt">networks</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln">31</span><span class="cl"><span class="w">      </span>- <span class="l">blog_net</span><span class="w">
</span></span></span><span class="line"><span class="ln">32</span><span class="cl"><span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="l">always</span><span class="w">
</span></span></span><span class="line"><span class="ln">33</span><span class="cl"><span class="w">  </span><span class="c"># 前端服务</span><span class="w">
</span></span></span><span class="line"><span class="ln">34</span><span class="cl"><span class="w">  </span><span class="nt">sg_blog_vue</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln">35</span><span class="cl"><span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">sg_blog_vue:01</span><span class="w">
</span></span></span><span class="line"><span class="ln">36</span><span class="cl"><span class="w">    </span><span class="nt">ports</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln">37</span><span class="cl"><span class="w">      </span>- <span class="m">80</span><span class="p">:</span><span class="m">80</span><span class="w">
</span></span></span><span class="line"><span class="ln">38</span><span class="cl"><span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="l">always</span><span class="w">
</span></span></span><span class="line"><span class="ln">39</span><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="ln">40</span><span class="cl"><span class="w"></span><span class="nt">networks</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln">41</span><span class="cl"><span class="w">  </span><span class="nt">blog_net</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln">42</span><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="ln">43</span><span class="cl"><span class="w"></span><span class="nt">volumes</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln">44</span><span class="cl"><span class="w">  </span><span class="nt">mysql_data</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln">45</span><span class="cl"><span class="w">    </span><span class="c">#使用已经存在的数据卷</span><span class="w">
</span></span></span><span class="line"><span class="ln">46</span><span class="cl"><span class="w">    </span><span class="nt">external</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="ln">47</span><span class="cl"><span class="w">  </span><span class="nt">redis_data</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln">48</span><span class="cl"><span class="w">    </span><span class="nt">external</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span></code></pre></div><p><img loading="lazy" src="https://i.postimg.cc/pV9Wz26g/screenshot-50.png" alt=""  />
</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="http://localhost:1313/tags/docker/">Docker</a></li>
    </ul>
<nav class="paginav">
  <a class="next" href="http://localhost:1313/posts/docker%E5%9C%A8ubuntu%E4%B8%8A%E5%AE%89%E8%A3%85mysql%E5%92%8Credis/">
    <span class="title">下一页 »</span>
    <br>
    <span>Docker在Ubuntu上部署项目案例</span>
  </a>
</nav>

  </footer><div id="tw-comment"></div>

<script>
  
  const getStoredTheme = () => localStorage.getItem("pref-theme") === "light" ? "light" : "dark";
  const setGiscusTheme = () => {
    const sendMessage = (message) => {
      const iframe = document.querySelector('iframe.giscus-frame');
      if (iframe) {
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');

      }

    }
    sendMessage({ setConfig: { theme: getStoredTheme() } })

  }

  document.addEventListener("DOMContentLoaded", () => {
    const giscusAttributes = {
      "src": "https://giscus.app/client.js",
      "data-repo": "houjinghao123\/houjinghao123.github.io",
      "data-repo-id": "R_kgDOMvdtTg",
      "data-category": "Announcements",
      "data-category-id": "DIC_kwDOMvdtTs4CiV_q",
      "data-mapping": "pathname",
      "data-strict": "0",
      "data-reactions-enabled": "1",
      "data-emit-metadata": "0",
      "data-input-position": "bottom",
      "data-theme": getStoredTheme(),
      "data-lang": "zh-CN",
      "data-loading": "lazy",
      "crossorigin": "anonymous",
    };

    
    const giscusScript = document.createElement("script");
    Object.entries(giscusAttributes).forEach(
      ([key, value]) => giscusScript.setAttribute(key, value));
    document.querySelector("#tw-comment").appendChild(giscusScript);

    
    const themeSwitcher = document.querySelector("#theme-toggle");
    if (themeSwitcher) {
      themeSwitcher.addEventListener("click", setGiscusTheme);

    }
    const themeFloatSwitcher = document.querySelector("#theme-toggle-float");
    if (themeFloatSwitcher) {
      themeFloatSwitcher.addEventListener("click", setGiscusTheme);

    }

  });
</script>
</article>
    </main>
    
<footer class="footer">
        <span><a href="https://houjinghao123.github.io/">©2024 phjhq&rsquo;s Blog</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>


<script src="https://cdnjs.cloudflare.com/ajax/libs/medium-zoom/1.1.0/medium-zoom.min.js"
  integrity="sha512-9ZKhgaFdKlsELap/dGw3Iaz5Bj+Las0XXZiRKYZaN9QArg6FtkD5rULNmNH4rTCTFxjPiBGr3MX8smRADRorDA=="
  crossorigin="anonymous" referrerpolicy="no-referrer"></script>

<script>
  var OSName = "unknown";
  var navApp = navigator.userAgent.toLowerCase();
  switch (true) {
    case (navApp.indexOf("win") != -1):
      OSName = "windows";
      break;
    case (navApp.indexOf("mac") != -1):
      OSName = "apple";
      break;
    case (navApp.indexOf("linux") != -1):
      OSName = "linux";
      break;
    case (navApp.indexOf("x11") != -1):
      OSName = "unix";
      break;
  }

  const images = Array.from(document.querySelectorAll(".post-content img"));
  images.forEach(img => {
    mediumZoom(img, {
      margin: 1,    
      scrollOffset: 40,  
      container: null,  
      template: null,  
      
    });
  });

  if (OSName == "windows") {
    document.body.className += ' win11'
  }
</script>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = '复制';

        function copyingDone() {
            copybutton.innerHTML = '已复制！';
            setTimeout(() => {
                copybutton.innerHTML = '复制';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
